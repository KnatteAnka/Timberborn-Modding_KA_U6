$OldGUID = @("m_Script: {fileID: -790041461, guid: 1bd6ccb667024f9c2b77daf7f62a4eed, type: 3}","m_Script: {fileID: 1800879565, guid: c1ff95bb5ae0e8b420075ec58add6f36, type: 3}","m_Script: {fileID: 1794062130, guid: 1bd6ccb667024f9c2b77daf7f62a4eed, type: 3}","m_Script: {fileID: -871492198, guid: c1ff95bb5ae0e8b420075ec58add6f36, type: 3}","m_Script: {fileID: -1066712947, guid: dd1baa4f323651ee41781eb84b2b1960, type: 3}","m_Script: {fileID: 9237227, guid: dd1baa4f323651ee41781eb84b2b1960, type: 3}","m_Script: {fileID: -730909465, guid: bcb85dd25e41826ab5a7dea12cff2430, type: 3}","m_Script: {fileID: -731835049, guid: b5f268a4cb31a93ed707a95d3a502b0e, type: 3}","m_Script: {fileID: -748958038, guid: 79523a2b71f4fae881a60ad2e723d456, type: 3}","m_Script: {fileID: 1589985441, guid: 4ed0189b1e1d234e361262ab78b6f74b, type: 3}","m_Script: {fileID: -1496982017, guid: 71874a96862cca0445075c2f72e705bf, type: 3}","m_Script: {fileID: -598504670, guid: 6e68475ee52ce568acbd493b99ce126d, type: 3}","m_Script: {fileID: 200649111, guid: 6db671ca2a10521151a0623ea7cc13c9, type: 3}","m_Script: {fileID: -2055952877, guid: fb0076526bca5246b24d6c818d68ce00, type: 3}","  m_Script: {fileID: -1555974455, guid: e4ae623d8e721d6ee862ef4896cd90b8, type: 3}","m_Script: {fileID: -1068735769, guid: 466296bcda0069d74809110857f4d4b6, type: 3}","m_Script: {fileID: 1699117225, guid: a03cd8c5f94193a6d4954176c7ceea85, type: 3}","m_Script: {fileID: 2060701405, guid: c9971e8fe3f7cd6e5d502e3d861173d6, type: 3}","m_Script: {fileID: -1394670982, guid: 8262cd5bd7701e10a9c276e5d964d688, type: 3}","m_Script: {fileID: -1822467985, guid: 8262cd5bd7701e10a9c276e5d964d688, type: 3}","m_Script: {fileID: -1185308891, guid: 9a9310670f1b8baea69f17ff3ea1e52b, type: 3}","m_Script: {fileID: -585314740, guid: 9a9310670f1b8baea69f17ff3ea1e52b, type: 3}","m_Script: {fileID: 956767693, guid: 5983c2788e896c63a1d82b5f707f879e, type: 3}","m_Script: {fileID: -1680664112, guid: 2cf0d2a7e560d63c9cb2673a04d45d56, type: 3}","m_Script: {fileID: 1557886385, guid: 9a9310670f1b8baea69f17ff3ea1e52b, type: 3}","m_Script: {fileID: -1514884223, guid: a01d35f43886f4b46e413d3c2ea20811, type: 3}","m_Script: {fileID: -1496700788, guid: 644c1295076bbdbb604b7f96aa6be9c2, type: 3}","m_Script: {fileID: 1385319953, guid: a01d35f43886f4b46e413d3c2ea20811, type: 3}","m_Script: {fileID: -1184203382, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: 1397707363, guid: b5b585a072a703d32743ea54a035c96c, type: 3}","m_Script: {fileID: -381097822, guid: 4ed0189b1e1d234e361262ab78b6f74b, type: 3}","m_Script: {fileID: -1486949439, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: 541562997, guid: 3d08eaebc9cf2cdafcd1795ddf8771cc, type: 3}","m_Script: {fileID: -913572135, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: 443178000, guid: a01d35f43886f4b46e413d3c2ea20811, type: 3}","m_Script: {fileID: -132089013, guid: b5b585a072a703d32743ea54a035c96c, type: 3}","m_Script: {fileID: 830965341, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: -594622411, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: 1516821267, guid: b0c4545210a508c255e4ebd4a145ed71, type: 3}","m_Script: {fileID: -2025228001, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: 1870102748, guid: a01d35f43886f4b46e413d3c2ea20811, type: 3}","m_Script: {fileID: -600689454, guid: 3c5a177bc275abc73c81bb2882a4cb3d, type: 3}","m_Script: {fileID: -1919928859, guid: ae17e402790c3a9884e91fc31aa0c578, type: 3}","m_Script: {fileID: 403710568, guid: 1c9dcb73a22bc8ced3d59cfdd1775b1c, type: 3}","m_Script: {fileID: 1933283616, guid: 9d9a15fd937d3c3e3eda286523371813, type: 3}","m_Script: {fileID: -455950880, guid: 71874a96862cca0445075c2f72e705bf, type: 3}","m_Script: {fileID: 1700995066, guid: 9d9a15fd937d3c3e3eda286523371813, type: 3}","m_Script: {fileID: 58764704, guid: cd0eb85e091d3abba5b77d6374ac6ef3, type: 3}","m_Script: {fileID: 1327350266, guid: 603f82a4140498c516499d72a9d347b6, type: 3}","m_Script: {fileID: -1115272012, guid: 75be7af0b34ada5bff62a949a3c4181d, type: 3}","m_Script: {fileID: -170773823, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: 2112321450, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}")
$NewGUID = @("m_Script: {fileID: -579399493, guid: 1bd6ccb667024f9c2b77daf7f62a4eed, type: 3}","m_Script: {fileID: 447443988, guid: c1ff95bb5ae0e8b420075ec58add6f36, type: 3}","m_Script: {fileID: 1475725842, guid: 1bd6ccb667024f9c2b77daf7f62a4eed, type: 3}","m_Script: {fileID: -1706396145, guid: c1ff95bb5ae0e8b420075ec58add6f36, type: 3}","m_Script: {fileID: 1099980749, guid: dd1baa4f323651ee41781eb84b2b1960, type: 3}","m_Script: {fileID: -1219910101, guid: dd1baa4f323651ee41781eb84b2b1960, type: 3}","m_Script: {fileID: -904470794, guid: bcb85dd25e41826ab5a7dea12cff2430, type: 3}","m_Script: {fileID: 1566945626, guid: b5f268a4cb31a93ed707a95d3a502b0e, type: 3}","m_Script: {fileID: -923837550, guid: 79523a2b71f4fae881a60ad2e723d456, type: 3}","m_Script: {fileID: -1146001497, guid: 4ed0189b1e1d234e361262ab78b6f74b, type: 3}","m_Script: {fileID: 413955577, guid: 71874a96862cca0445075c2f72e705bf, type: 3}","m_Script: {fileID: -1839023324, guid: 6e68475ee52ce568acbd493b99ce126d, type: 3}"," m_Script: {fileID: -1587067794, guid: 6db671ca2a10521151a0623ea7cc13c9, type: 3}","m_Script: {fileID: -255277544, guid: fb0076526bca5246b24d6c818d68ce00, type: 3}","  m_Script: {fileID: 1691504014, guid: e4ae623d8e721d6ee862ef4896cd90b8, type: 3}","m_Script: {fileID: 1223716553, guid: 466296bcda0069d74809110857f4d4b6, type: 3}","m_Script: {fileID: 163647624, guid: a03cd8c5f94193a6d4954176c7ceea85, type: 3}","m_Script: {fileID: 55736861, guid: c9971e8fe3f7cd6e5d502e3d861173d6, type: 3}","m_Script: {fileID: -267153151, guid: 8262cd5bd7701e10a9c276e5d964d688, type: 3}","m_Script: {fileID: -304289300, guid: 8262cd5bd7701e10a9c276e5d964d688, type: 3}","m_Script: {fileID: 739307562, guid: 9a9310670f1b8baea69f17ff3ea1e52b, type: 3}","m_Script: {fileID: -1085867095, guid: 9a9310670f1b8baea69f17ff3ea1e52b, type: 3}","m_Script: {fileID: 1831623156, guid: 5983c2788e896c63a1d82b5f707f879e, type: 3}","m_Script: {fileID: 1953574493, guid: 2cf0d2a7e560d63c9cb2673a04d45d56, type: 3}","m_Script: {fileID: 492938593, guid: 9a9310670f1b8baea69f17ff3ea1e52b, type: 3}","m_Script: {fileID: 484218558, guid: a01d35f43886f4b46e413d3c2ea20811, type: 3}","m_Script: {fileID: -650948309, guid: 644c1295076bbdbb604b7f96aa6be9c2, type: 3}","m_Script: {fileID: 1870102748, guid: a01d35f43886f4b46e413d3c2ea20811, type: 3}","m_Script: {fileID: -386533878, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: 1796291328, guid: b5b585a072a703d32743ea54a035c96c, type: 3}","m_Script: {fileID: 434579712, guid: 4ed0189b1e1d234e361262ab78b6f74b, type: 3}","m_Script: {fileID: 803963638, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: 1350353258, guid: 3d08eaebc9cf2cdafcd1795ddf8771cc, type: 3}","m_Script: {fileID: 166878786, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: 1672878266, guid: a01d35f43886f4b46e413d3c2ea20811, type: 3}","m_Script: {fileID: 1751046711, guid: b5b585a072a703d32743ea54a035c96c, type: 3}","m_Script: {fileID: 1049139611, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: -1429248724, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: 1859189143, guid: b0c4545210a508c255e4ebd4a145ed71, type: 3}","m_Script: {fileID: 1351926144, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: -979173865, guid: a01d35f43886f4b46e413d3c2ea20811, type: 3}","m_Script: {fileID: 923026739, guid: 3c5a177bc275abc73c81bb2882a4cb3d, type: 3}","m_Script: {fileID: 873244395, guid: ae17e402790c3a9884e91fc31aa0c578, type: 3}","m_Script: {fileID: 151550540, guid: 1c9dcb73a22bc8ced3d59cfdd1775b1c, type: 3}","m_Script: {fileID: 1796300005, guid: 9d9a15fd937d3c3e3eda286523371813, type: 3}","m_Script: {fileID: -747059159, guid: 71874a96862cca0445075c2f72e705bf, type: 3}","m_Script: {fileID: -813592589, guid: 9d9a15fd937d3c3e3eda286523371813, type: 3}","m_Script: {fileID: -1701114299, guid: cd0eb85e091d3abba5b77d6374ac6ef3, type: 3}","m_Script: {fileID: 1779574170, guid: 603f82a4140498c516499d72a9d347b6, type: 3}","m_Script: {fileID: -1222417671, guid: 75be7af0b34ada5bff62a949a3c4181d, type: 3}","m_Script: {fileID: 1477343039, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}","m_Script: {fileID: 1791524051, guid: f52221e1b73d7a1af6ce63101ea50e01, type: 3}")

$FileSufix = ".\*.prefab"

Function Get-Folder($initialDirectory="")

{
    [System.Reflection.Assembly]::LoadWithPartialName("System.windows.forms")|Out-Null

    $foldername = New-Object System.Windows.Forms.FolderBrowserDialog
    $foldername.Description = "Select a folder"
    $foldername.rootfolder = "MyComputer"
    $foldername.SelectedPath = $initialDirectory
    $Dialog = $foldername.ShowDialog()
    if($Dialog -eq "OK")
    {
        $folder += $foldername.SelectedPath
        return $folder
    }

    
    return -1
}

#$File=$args[0]
cls
Write-host -----------------------------------
Write-host -- Starting Mass replacer        --
Write-host -----------------------------------
$CurrentDir = Get-Location

$CurrentDir = Get-Folder -initialDirectory $CurrentDir

if ( $CurrentDir -eq -1){
 exit
 }
$Subfolders = Get-ChildItem -Path $CurrentDir






Write-Host $CurrentDir
Write-host -----------------------------------
foreach ($Folders in $Subfolders){
    
    if ("$Folders" -ne "Mods") {
     #Write-Host --- !$Folders!
     continue
     }
     $CurrentDir = Join-Path -Path $CurrentDir -ChildPath $Folders
    Write-Host $Folders
}

Write-Host $CurrentDir$FileSufix
Write-host -----------------------------------
#Get all prefabs inc subfolders

$FilesToCheck = Get-ChildItem -Path $CurrentDir$FileSufix -Recurse -Force
foreach ($CheckFile in $FilesToCheck){
    Write-Host $CheckFile    
    $content = [System.IO.File]::ReadAllText("$CheckFile")
    $Count = 0
    For ($Loop = 0; $Loop -lt $OldGUID.count ; $Loop++){
        $Found = $content.IndexOf($OldGUID[$Loop])
        if ($Found -ne -1) {
            $Count++
            Write-Host Old: $OldGUID[$Loop]
            Write-Host New: $NewGUID[$Loop]
        }
        $content = $content.Replace($OldGUID[$Loop],$NewGUID[$Loop])
        
    }
    [System.IO.File]::WriteAllText("$CheckFile", $content)
    
}
Write-host -----------------------------------
Write-Host --------------- Done --------------
Write-host -----------------------------------
pause
exit
